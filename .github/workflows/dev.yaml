name: dev

on:
  push:
    branches:
      - 'dev'

jobs:
  deploy_dev:
    name: Deploy dev environment.
    runs-on: ubuntu-22.04
    steps:
      -
        name: Deploy.
        env:
          KEY: ${{ secrets.SSH_KEY }}
          REMOTE_ADDR: ${{ secrets.SSH_REMOTE_ADDR }}
          USER: ${{ secrets.SSH_USER }}
        run: |
          echo "$KEY" > key.pem
          chmod 600 key.pem
          
          ssh -o StrictHostKeyChecking=no -i key.pem $USER@$REMOTE_ADDR <<EOF
            
            ls;
          EOF
          
          rm -f key.pem